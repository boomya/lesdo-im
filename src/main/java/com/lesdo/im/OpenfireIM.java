package com.lesdo.im;import com.lesdo.im.packetExtension.HeadImageIDExtension;import com.lesdo.im.packetExtension.NickNameExtension;import com.lesdo.im.packetExtension.Received;import com.lesdo.im.packetExtension.SendTimeExtension;import com.lesdo.im.util.SystemGlobals;import org.jivesoftware.smack.Connection;import org.jivesoftware.smack.ConnectionConfiguration;import org.jivesoftware.smack.XMPPConnection;import org.jivesoftware.smack.packet.Message;import org.jivesoftware.smack.packet.Message.Type;public class OpenfireIM {    private static String IP = SystemGlobals.get("openfire_ip");//	private static String IP = "115.28.3.10"; //正式    // private static String P_IP = "115.29.33.189";    private static String P_IP = SystemGlobals.get("p_ip");    /**     * 获取连接     * @return connection     */    public static Connection getConnection() {        String ip = IP;        Integer dk = 5222;        ConnectionConfiguration config = new ConnectionConfiguration(ip, dk);//		config.setSecurityMode(SecurityMode.required);//		config.setSASLAuthenticationEnabled(false);//		config.setCompressionEnabled(false);//		config.setDebuggerEnabled(true);		Connection connection = new XMPPConnection(config);		return connection;	}	public static void main(String[] args) {		try {			Connection con = OpenfireIM.getConnection();			con.connect();			// 正式环境下1222的账号密码			// con.login("1222", "b59c67bf196a4758191e42f76670ceba");//			// con.login("93063", "88cd4d16d54d5a89cb3652939e74cd72");//			// 测试环境下的1222账号密码			con.login("1009", "e10adc3949ba59abbe56e057f20f883e");//			 con.loginAnonymously();// 匿名登录。			System.out.println("Authenticated = " + con.isAuthenticated()					+ "  " + con.getUser());			for (int i = 0; i < 1; i++) {				System.out.println("i==" + i);				Message m = new Message();								m.setBody("i=" + i);// 设置消息。				// m.setBody("ZICumIXbEOrx+nosiv8+KDVFlb4A74XMJqiIV2geIqWYXpb8t8rAa7c2tG7V c4NIHorsVnI5SJrIBUKzRtUa+PL4wAlHhaXF+EErsFUYQZzy9jK1DJKoyPwN XZHMpyzvvCr56YBXU+mDXvZgtP2z3VGm0+EVSeT6vswD7nhb90olSqmBO1lT 1kmykDDhNbESXTqL8edKxzZ791CKNaikVQ==");				// DesUtil				m.setSubject("echo");				m.setType(Type.normal);				SendTimeExtension sendTime = new SendTimeExtension();				sendTime.setSendTime(System.currentTimeMillis() / 1000);				NickNameExtension nickName = new NickNameExtension();				nickName.setNickName("小Do");				HeadImageIDExtension headImageID = new HeadImageIDExtension();				// headImageID.setHeadImageID("157585_160_160");				headImageID.setHeadImageID("493505_160_160");				Received received = new Received();																m.addExtension(sendTime);				m.addExtension(nickName);				m.addExtension(headImageID);				m.addExtension(received);												// m.setTo("all@broadcast." + P_IP);// all@broadcast.yyp-pc				// // 说明一下只需要改后面的yyp-pc改成 相应的域名。				// // 我这里是自己机器的名字。				m.setTo("32932@" + P_IP);				con.sendPacket(m);			}		} catch (Exception e) {			// TODO Auto-generated catch block			e.printStackTrace();		}	}}